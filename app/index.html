<!DOCTYPE html>
<html lang="en">

<head>
    <title>Zendin</title>

    <script src="https://unpkg.com/@croquet/croquet@0.4.0"></script>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githubusercontent.com/n5ro/aframe-extras/master/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.rawgit.com/mrturck/aframe-joystick/master/joystick.min.js"></script>
    <script src="https://unpkg.com/aframe-template-component@3.x.x/dist/aframe-template-component.min.js"></script>
    <script src="https://unpkg.com/aframe-layout-component@4.x.x/dist/aframe-layout-component.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@5.x.x/dist/aframe-event-set-component.min.js"></script>
    <script src="https://raw.githubusercontent.com/msj121/aframe-animation-component/master/dist/aframe-animation-component.min.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.min.js"></script>
    <script src="https://unpkg.com/aframe-physics-extras/dist/aframe-physics-extras.min.js"></script>
    <script src="https://unpkg.com/super-hands@^3.0.1/dist/super-hands.min.js"></script>

    <script src="./scripts/constants.js"></script>
    <script src="./scripts/system.js"></script>
    <script src="./scripts/component.js"></script>
    <script src="./scripts/generate-base-garden.js"></script>
    <script src="./scripts/garden-controls.js"></script>
    <script src="./scripts/index.js" type="module"></script>
    <script src="./scripts/selector.js"></script>
  
    <!-- meditation -->
    <script src="./scripts/meditation-emitter.js"></script>
    <script src="./scripts/meditation-mode.js"></script>
    <script src="./scripts/meditation-light-mode.js"></script>
    <script src="./scripts/meditation-script.js"></script>
  
    <script src="./scripts/blink-teleportation.js"></script>
    <script src="./scripts/teleportation-checkpoint.js"></script>
    <!-- new teleportation -->
    <script src="https://cdn.jsdelivr.net/npm/aframe-blink-controls/dist/aframe-blink-controls.min.js"></script>
  
    <!-- yoga -->
    <script src="./scripts/yoga-emitter.js"></script>
    <script src="./scripts/yoga-mode.js"></script>

    <!-- menu -->
    <script src="./scripts/menu-controls.js"></script>
    <script src="./scripts/menu-button.js"></script>
</head>

<body>
    <a-scene renderer="colorManagement: true; physicallyCorrectLights: true" physics croquet cursor="rayOrigin: mouse" >
        <!-- Load in assets -->
        <a-assets>
            <a-asset-item id="env_arrow" src="../assets/env_arrow.obj"></a-asset-item>

            <a-asset-item id="corner-wall-asset" src="../assets/glb/corner-wall-simple.glb"></a-asset-item>
            <a-asset-item id="single-wall-asset" src="../assets/glb/single-wall-simple.glb"></a-asset-item>
            <a-asset-item id="right-hand-low" src="../assets/glb/rightHandLow.glb"></a-asset-item>
            <a-asset-item id="left-hand-low" src="../assets/glb/leftHandLow.glb"></a-asset-item>
            <img id="sky-img" crossorigin="anonymous" src="https://cdn.glitch.com/2b4aff49-28a2-40af-847a-d2b291f6c30e%2F47e93852-bc4e-485b-bde3-7923ba2679db.image.png?v=1617686253924">

            <template id="user-template">
                <a-entity class="user">
                    <a-sphere class="head" color="#ffffff" scale="0.2 0.3 0.2"></a-sphere>
                    <a-entity class="face" position="0 0.05 0">
                        <a-sphere class="eye" color="#efefef" position="0.16 0.08 -0.1" scale="0.05 0.05 0.05">
                            <a-sphere class="pupil" color="#000" position="0 0 -1" scale="0.2 0.2 0.2"></a-sphere>
                        </a-sphere>
                        <a-sphere class="eye" color="#efefef" position="-0.16 0.08 -0.1" scale="0.05 0.05 0.05">
                            <a-sphere class="pupil" color="#000" position="0 0 -1" scale="0.2 0.2 0.2"></a-sphere>
                        </a-sphere>
                        <a-cylinder class="mouth" color="#000000" position="0 -0.128 -0.132" rotation="130 0 0"
                            scale="0.1 0.1 0.1"></a-cylinder>
                    </a-entity>
                </a-entity>
            </template>

            <template id="user-hands">
                <a-entity class="left"
                          id="leftHand"
                          hand-controls="hand: left; handModelStyle: lowPoly; color: #ff0000"
                          raycaster="showLine: false; enabled: false; objects: .leftclickable;"
                          garden-controls="menuId: menuItems; previewItemId: leftItem; gardenBaseId: garden; newAssetContainerId: new-asset-container">
                    <a-entity id="leftItem" file="kfarr_bases_valencia" objectGroup="plants" objectId="0" gltf-model="url(../assets/glb/cherry-blossom.glb)" rotation="-5 0 0" scale="0.05 .05 .05" position="0 -0.04 -0.4"></a-entity>
                    <a-entity select-bar="controllerID: leftHand" id="menuItems" scale="0.7 0.7 0.7" position="0 0.14 -0.03" rotation="-85 0 0">
                        <optgroup label="Plants" value="plants">
                            <option value="cherry-blossom" src="url(../assets/img/cherry-blossom.png)" selected>Cherry Blossom</option>
                            <option value="evergreen-tree-1" src="url(../assets/img/evergreen-tree-1.png)">Evergreen Tree 1</option>
                            <option value="evergreen-tree-2" src="url(../assets/img/evergreen-tree-2.png)">Evergreen Tree 2</option>
                            <option value="tall-tree" src="url(../assets/img/tall-tree.png)">Tall Tree</option>
                            <option value="round-tree-1" src="url(../assets/img/round-tree-1.png)">Round Tree 1</option>
                            <option value="short-grass" src="url(../assets/img/short-grass.png)">Short Grass</option>
                            <option value="potted_plant_small" src="url(../assets/img/potted_plant_small.png)">Potted Plant</option>
                        </optgroup>
                    </a-entity>
                </a-entity>

<!--                 <a-entity class="right" id="rightHand" super-hands hand-controls="hand: right; handModelStyle: lowPoly; color: #00ff00"
                          sphere-collider="objects: a-box"
                          raycaster="showLine: true; objects: .clickable" laser-controls="hand: right; model: false"> -->
                <a-entity class="right" id="rightHand" super-hands hand-controls="hand: right; handModelStyle: lowPoly; color: #00ff00"
                          raycaster="showLine: true; objects: .rightclickable" laser-controls="hand: right; model: false"
                          blink-controls="cameraRig: #camRig; teleportOrigin: #cam; collisionEntities: #floor"
                          menu-controls>
                </a-entity>
            </template>

            <template id="user-hands-fake">
                <a-entity class="user">
                    <a-entity id="leftHandFake" class="left" gltf-model="#left-hand-low"></a-entity>
                    <a-entity id="rightHandFake" class="right" gltf-model="#right-hand-low"></a-entity>
                </a-entity>
            </template>

            <!-- <a-mixin id="poster" geometry="primitive: plane; width: 0.544768; height: 0.786432"
                material="color: white; shader: flat"></a-mixin> -->
          
            <!-- testing drag and drop object functionality - not showing up? -->
<!--             <a-mixin id="cherry-blossom" src="../assets/glb/cherry-blossom.glb"
                     hoverable grabbable stretchable draggable droppable shadow
                     event-set__hoveron="_event: hover-start; material.opacity: 0.7; transparent: true"
                     event-set__hoveroff="_event: hover-end; material.opacity: 1; transparent: false"
                     event-set__dragon="_event: dragover-start; material.wireframe: true"
                     event-set__dragoff="_event: dragover-end; material.wireframe: false"></a-mixin> -->
            <!-- end of testing drag and drop -->
          
            <a-asset-item
              id="lantern"
              src="../assets/glb/stone-lantern.glb"
            ></a-asset-item>
            <a-asset-item
              id="flame"
              src="../assets/glb/lantern-flame.glb"
            ></a-asset-item>
          
            <!-- music -->
            <audio id="background-music" src="../assets/Music/default.m4a"></audio>
            <audio id="meditation-music" src="../assets/Music/meditation.m4a"></audio>

            <audio id="As-the-rain" src="../assets/Music/As-the-rain_AdobeStock_353732184_preview.m4a"></audio>
            <audio id="Breath-of-life" src="../assets/Music/Breath-Of-Life_AdobeStock_331838231_preview.m4a"></audio>
            <audio id="Imaginary-waterfalls" src="../assets/Music/Imaginary-Waterfalls_AdobeStock_356916496_preview.m4a"></audio>

            <!--meditation scripts-->
            <audio id="confidence-meditation" src="../assets/meditation-scripts/Confidence.mp3"></audio>
            <audio id="meditation-1" src="../assets/meditation-scripts/Meditation 1.mp3"></audio>
            <audio id="rain" src="../assets/meditation-scripts/Rain.mp3"></audio>
          
            <!--a-asset-item id="meditation-building" src="../assets/glb/meditation-room.glb"></a-asset-item-->
            <a-asset-item id="meditation-building" src="https://cdn.glitch.com/d278d22e-cba0-423d-9948-00c332e0a3d7%2Fmeditation-room-small.glb?v=1618960941936"></a-asset-item>
          
            <!-- yoga images -->
            <!-- note: there's gotta be a better way to load these. -->
            <img id="yoga-0" src="../assets/img/yoga/yoga-0.png">
            <img id="yoga-1" src="../assets/img/yoga/yoga-1.png">
            <img id="yoga-2" src="../assets/img/yoga/yoga-2.png">
            <img id="yoga-3" src="../assets/img/yoga/yoga-3.png">
            <img id="yoga-4" src="../assets/img/yoga/yoga-4.png">
            <img id="yoga-5" src="../assets/img/yoga/yoga-5.png">
            <img id="yoga-6" src="../assets/img/yoga/yoga-6.png">
            <img id="yoga-7" src="../assets/img/yoga/yoga-7.png">
            <img id="yoga-8" src="../assets/img/yoga/yoga-8.png">
            <img id="yoga-9" src="../assets/img/yoga/yoga-9.png">
            <img id="yoga-10" src="../assets/img/yoga/yoga-10.png">
            <img id="yoga-11" src="../assets/img/yoga/yoga-11.png">
            <img id="yoga-12" src="../assets/img/yoga/yoga-12.png">
            <img id="yoga-13" src="../assets/img/yoga/yoga-13.png">
            <img id="yoga-14" src="../assets/img/yoga/yoga-14.png">
            
            <!-- menu -->
            <img id="meditation-img" src="../assets/img/menu/meditation.png"/>
            <img id="yoga-img" src="../assets/img/menu/yoga.png"/>

            <a-mixin
              id="frame"
              geometry="primitive: plane; width: 0.5783552; height: 0.8192"
              material="color: white; shader: flat"
              animation__scale="property: scale; to: 1.2 1.2 1.2; dur: 500; easing: easeOutExpo; startEvents: mouseenter"
              animation__scale_reverse="property: scale; to: 1 1 1; dur: 500; easing: easeOutExpo; startEvents: mouseleave"
            ></a-mixin>
            <a-mixin
              id="poster"
              geometry="primitive: plane; width: 0.544768; height: 0.786432"
              material="color: white; shader: flat"
              position="0 0 0.008"
            ></a-mixin>
            <a-mixin
              id="info-text"
              geometry="primitive: plane; width: 0.544768; height: 0.786432"
              material="color: black; shader: flat; opacity: 0"
              position="0 0 0.01"
            >
            </a-mixin>

            <template id="activity-menu-template">
              <a-entity id="ui" position="0 1.5 -2" visible="false">
                <!-- 1 -->
                <a-entity id="first-menu" class="submenu" visible="false">
                  <a-entity id="meditation-button" class="option" mixin="frame" position="-0.4 0 0"
                    menu-button="title: Meditate; info: Take a breather; img: #meditation-img; width: 2">
                  </a-entity>
                  <a-entity id="yoga-button" class="option" mixin="frame" position="0.4 0 0"
                    menu-button="title: Yoga; info: Stretch out a bit; img: #yoga-img; width: 2">
                  </a-entity>
                </a-entity> <!-- 1 -->
                <!-- meditation submenu - removed class="rightclickable" from each button to avoid raycasting on it  -->
                <a-entity id="meditation-menu" class="submenu" visible="false">
                  <a-entity id="guided-meditation-button" class="option" mixin="frame" position="-0.7 0 0"
                    menu-button="title: Guided Meditation; info: Let us walk you through; img: #meditation-img; width: 1.2">
                  </a-entity>
                  <a-entity id="story-telling-button" class="option" mixin="frame" position="0 0 0"
                    menu-button="title: Story Telling; info: Listen to a brief story; img: #meditation-img; width: 1.2">
                  </a-entity>
                  <a-entity id="confidence-booster-button" class="option" mixin="frame" position="0.7 0 0"
                    menu-button="title: Confidence Booster; info: Feel good about yourself; img: #meditation-img; width: 1.2">
                  </a-entity>
                </a-entity> <!-- meditation submenu -->
                <!-- yoga submenu -->
                <a-entity id="yoga-menu" class="submenu" visible="false">
                  <!-- samples -->
                  <a-entity id="yoga-button-1" class="option" mixin="frame" position="-0.7 0 0"
                    menu-button="title: Yoga 1; info: Yoga 1 Info; img: #yoga-img; width: 1.2">
                  </a-entity>
                  <a-entity id="yoga-button-2" class="option" mixin="frame" position="0 0 0"
                    menu-button="title: Yoga 2; info: Yoga 2 Info; img: #yoga-img; width: 1.2">
                  </a-entity>
                  <a-entity id="yoga-button-3" class="option" mixin="frame" position="0.7 0 0"
                    menu-button="title: Yoga 3; info: Yoga 3 Info; img: #yoga-img; width: 1.2">
                  </a-entity>
                </a-entity> <!-- meditation submenu -->
              </a-entity>
            </template>
            <!-- menu -->
        </a-assets>
      
        <!-- yoga stuff -->
        <a-cylinder id="yoga-cylinder" class="rightclickable" position="3 0.75 14" radius="0.5" height="1.5" color="#FFC65D" yoga-emitter></a-cylinder>
        <a-image id="yoga-images" width="1.5" height="1.5" position="0 0.75 14.5" rotation="0 180 0">
          <!-- frame -->
          <a-box width="3" height="0.5" position="0 -0.95 0" color="#DDBE91"></a-box>
          <a-box width="1.6" height="0.1" depth="0.5" position="0 0.75 0" color="#DDBE91"></a-box>
          <a-box width="1.6" height="0.1" depth="0.5" position="0 -0.75 0" color="#DDBE91"></a-box>
          <a-box width="1.6" height="0.1" depth="0.5" position="0.75 0 0" color="#DDBE91" rotation="0 0 90"></a-box>
          <a-box width="1.6" height="0.1" depth="0.5" position="-0.75 0 0" color="#DDBE91" rotation="0 0 90"></a-box>
        </a-image>
        <a-box id="yoga-mat" height="0.1" width="1" depth="2" position="0 0 11" color="#DB7093"></a-box>
        <a-entity id="timer" position="2 0.5 14" scale="10 10 10" rotation="0 180 0" visible="false"
                  text="color: black; align: center; value: TEST TEXT;"></a-entity>
      

        <a-entity light="type: ambient; color: #BBB" meditation-light-mode></a-entity>
        <a-entity id="light" light="type: point; color: #f4f68e; intensity: 0.7; castShadow: true" position="15.648 15.903 -17.785" meditation-light-mode></a-entity>
        <a-sky id="sky" src="#sky-img" color="#FFF"
               sound="on: model-loaded; src: #background-music; autoplay: true; loop: true; positional: false; volume: 0.1"
               meditation-mode yoga-mode>
        </a-sky>

        <a-entity id="garden" base-garden="sceneWidth: 30; sceneDepth: 30"></a-entity>
        <a-entity id="new-asset-container" croquet="name: new-asset-container"></a-entity>

<!--         <a-entity id="garden" base-garden="sceneWidth: 10; sceneDepth: 10"></a-entity> -->
        <!-- Camera and hands live here for teleportation -->
      
        <!-- testing teleportation points 
        <a-sphere class="clickable" blink-teleportation teleportation-checkpoint position="0 0 6"></a-sphere>
        <a-entity class="clickable" gltf-model="url(../assets/glb/tall-rock.glb)" blink-teleportation teleportation-checkpoint position="5 0 0"></a-entity>
        -->
        
        <!-- controls tutorial -->
<!--         <a-entity gltf-model="#single-wall-asset"
                  position="-2 0 -3.55"
                  rotation="0 180 0">
        </a-entity>
        <a-entity position="-2 1.5 -3.5"
                  scale="2.5 2.5 2.5"
                  text="color: black; align: center; font: exo2bold;
                        value: Left Hand: \ngrip to enable menu, \njoystick to navigate menu, \ny to place, \nx to undo;">
        </a-entity>
        <a-entity gltf-model="#single-wall-asset"
                  position="0 0 -3.55"
                  rotation="0 180 0">
        </a-entity>
        <a-entity position="0 1.5 -3.5"
                  scale="2.5 2.5 2.5"
                  text="color: black; align: center; font: exo2bold;
                        value: Meditation Mode\n|\nV;">
        </a-entity>
        <a-box position="0 1 -3.45"
               scale="0.5 0.5 0.1"
               color="#A9A9A9">
        </a-box>
        <a-cylinder position="0 1 -3.4"
                    radius="0.15"
                    height="0.1"
                    rotation="90 0 0"
                    class="clickable"
                    color="#FFC65D"
                    meditation-emitter>
        </a-cylinder>
        <a-entity gltf-model="#single-wall-asset"
                  position="2 0 -3.55"
                  rotation="0 180 0">
        </a-entity>
        <a-entity position="2 1.5 -3.5"
                  scale="2.5 2.5 2.5"
                  text="color: black; align: center; font: exo2bold;
                        value: Right Hand: \nclick to on teleport points \non the floor to move!\nclick on buttons to trigger them!;">
        </a-entity> -->
        
        <!-- testing out meditation start -->
        <a-entity
          class="lantern"
          gltf-model="#lantern"
          position="2 0 -3"
          croquet="name: lantern-1"
        ></a-entity>
        <a-entity
          class="lantern"
          gltf-model="#lantern"
          position="-2 0 -3"
          croquet="name: lantern-2"
        ></a-entity>
        <a-plane
          rotation="-90 0 0"
          position="0 0.1 1"
          scale="1.5 1.5 1.5"
          color="#FFC65D"
        ></a-plane>
      
        <a-entity
          name="default" 
          gltf-model="#meditation-building" 
          scale="0.5 0.5 0.5" 
          rotation="0 90 0" 
          position="0 0.1 -1" 
          croquet="name: med"
        ></a-entity>
      
        <a-entity id="camRig">
          <a-camera
            id="cam"
            wasd-controls-enabled="true"  
            look-controls
          ></a-camera>
        </a-entity>
    </a-scene>

    <script src="./scripts/joystick.js"></script>
    <script src="./scripts/randomizeLocation.js"></script>
</body>

</html>